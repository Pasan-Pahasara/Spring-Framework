<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>POS | Order Details</title>
    <link rel="icon" href="assets/img/favicon.png">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Bootstrap for Style -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <!-- Custom Style Sheet -->
    <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body class="container-fluid">

<header id="headerBar" class="row">

    <nav class="navbar navbar-expand-lg border-bottom shadow-lg sticky-top navbar-dark"
         style="background-color: #232121">
        <div class="container-fluid">
            <a class="navbar-brand" href="#" style="font-size: 18px; color: #A87E5A;">
                <!-- navbar image setup -->
                <img alt="" src="assets/img/favicon.png"
                     style="width: 70px;height: 58px;position: absolute;left: 0;top: 0;"><span
                    style="font-size: 20px; font-weight: bolder; color: #f0f0f0; margin-left: 46px;">YᑌᗰᗰY</span> treats</a>
            <!--Toggle button-->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse " id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link" aria-current="page" href="#"><i
                                class="bi bi-house-fill"></i>
                            Home</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" aria-current="page" href="./customer.html"><i
                                class="bi bi-people-fill"></i> Customers</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" aria-current="page" href="./item.html"><i
                                class="bi bi-handbag-fill"></i> Items</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" aria-current="page" href="./order.html"><i
                                class="bi bi-cart-check-fill"></i> Orders</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="./orderDetails.html"><i class="bi bi-card-checklist"></i> Orders
                            Details</a>
                    </li>

                </ul>
                <ul class="navbar-nav me-6 mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link" aria-current="page" href="#"><i class="bi bi-person-plus-fill"></i>
                            Sign Up</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" aria-current="page" href="#"><i class="bi bi-box-arrow-right"></i>
                            Log Out</a>
                    </li>
                </ul>
                </ul>
            </div>
        </div>
    </nav>

</header>

<!--order details section start-->
<main class="row mx-3 justify-content-center">
       <section class="col-12 mb-0">
            <div class="row">
                <div id="display"
                     style="background: linear-gradient(to right, #000000, #b88962);box-shadow: rgb(0 0 0 / 25%) 0 14px 28px, rgb(0 0 0 / 22%) 0 10px 10px!important;"
                     class="p-1 px-3 col rounded-3 fw-bolder bg-secondary text-light fs-3 mt-4 shadow-sm"><i
                        class="fas fa-user-edit me-2"></i>Order Details
                </div>
            </div>
        </section>

    <div class="row justify-content-evenly h-50">

        <!-- Table Order -->
        <section class="d-flex flex-column h-100 col-10 col-xl-11 bg-white shadow-lg rounded-4 align-items-center p-1 mt-4 mb-4">
            <h3 class="text-center mb-3 p-1 text-light rounded-3 col-12" style="background: linear-gradient(to left, #000000, #b88962);box-shadow: rgb(0 0 0 / 25%) 0 14px 28px, rgb(0 0 0 / 22%) 0 10px 10px!important;">
                Orders</h3>
            <div class="row overflow-auto h-60 col-11 col-lg-11 rounded-2 justify-content-around">
                <table class="table table-striped table-hover">
                    <thead class="text-white sticky-top">
                    <tr>
                        <th scope="col">Order ID</th>
                        <th scope="col">Order Date</th>
                        <th scope="col">Customer ID</th>
                        <th scope="col">Sub Total</th>
                        <th scope="col">Discount</th>
                    </tr>
                    </thead>
                    <tbody id="tblOrder">

                    </tbody>
                </table>
            </div>
        </section>

        <!-- Table Order Details-->
        <section
                class="d-flex flex-column h-100 col-10 col-xl-11 bg-white shadow-lg rounded-4 align-items-center p-1">
            <h3 class="text-center mb-3 p-1 text-light rounded-3 col-12"style="background: linear-gradient(to left, #000000, #b88962);box-shadow: rgb(0 0 0 / 25%) 0 14px 28px, rgb(0 0 0 / 22%) 0 10px 10px!important;">
                Orders Details</h3>
            <div class="row overflow-auto h-60 col-11 col-lg-11 rounded-2 justify-content-around">
                <table class="table table-striped table-hover">
                    <thead class="text-white sticky-top">
                    <tr>
                        <th scope="col">Order ID</th>
                        <th scope="col">Customer ID</th>
                        <th scope="col">Customer Name</th>
                        <th scope="col">Item Code</th>
                        <th scope="col">Item Name</th>
                        <th scope="col">Qty</th>
                        <th scope="col">Total</th>
                    </tr>
                    </thead>
                    <tbody id="tblOrderDetails">

                    </tbody>
                </table>
            </div>
        </section>

    </div>
</main>
<!--order details section end-->

<!-- Bootstrap for JS -->
<script src="assets/js/bootstrap.min.js"></script>

<!-- jQuery for JS -->
<script src="assets/jQuery/jquery-3.6.1.min.js"></script>

<!-- Swal CDN link -->
<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    let baseUrl = "http://localhost:8080/jpa/";//Back end එකේ location URL එක.

    getAllOrders();
    getAllOrderDetails();

    function getAllOrders() {
        $("#tblOrder").empty();
        $.ajax({
            url: baseUrl + "purchase?option=LoadOrders",//දාපු baseUrl එක append කරනවා
            dataType:"json",
            success: function (res) {
                console.log(res);
                for (let o of res.data) {
                    $("#tblOrder").append(`<tr><td>${o.oid}</td><td>${o.date}</td><td>${o.cusId}</td><td>${o.subTotal}</td><td>${o.discount}</td></tr>`)
                }
            },
            error: function (error) {
                let message = JSON.parse(error.responseText).message;
                alert(message);
            }
        });
    }

    function getAllOrderDetails() {
        $("#tblOrderDetails").empty();
        $.ajax({
            url: baseUrl + "purchase?option=LoadOrderDetails",//දාපු baseUrl එක append කරනවා
            dataType: "json",
            success: function (res) {
                console.log(res);
                for (let od of res.data) {
                    $("#tblOrderDetails").append(`<tr><td>${od.oid}</td><td>${od.id}</td><td>${od.name}</td><td>${od.code}</td><td>${od.description}</td><td>${od.qty}</td><td>${od.price}</td></tr>`)
                }
            },
            error: function (error) {
                let message = JSON.parse(error.responseText).message;
                alert(message);
            }
        });
    }
</script>
</body>
</html>